

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.pyLIQTR.clam.geometry &mdash; pyLIQTR 1.3.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />

  
    <link rel="shortcut icon" href="../../../../_static/pyliqtr_logo.png"/>
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=e358f374"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            pyLIQTR
              <img src="../../../../_static/pyliqtr_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../document.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release.html">Release strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../debugger.html">Debugger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../best_practice.html">Best Practices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api.html">pyLIQTR API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api-internal.html">Internal API reference, for users customizing behavior</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../_autosummary/pyLIQTR.html">pyLIQTR</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyLIQTR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.pyLIQTR.clam.geometry</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.pyLIQTR.clam.geometry</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Copyright (c) 2024 Massachusetts Institute of Technology </span>
<span class="sd">SPDX-License-Identifier: BSD-2-Clause</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">################################################################################</span>
<span class="c1">###                                                                          ###</span>
<span class="c1">###     GEOMETRY  -  Specification and manipulation of atomic geometries     ###</span>
<span class="c1">###                                                                          ###</span>
<span class="c1">################################################################################</span>


<span class="kn">import</span> <span class="nn">numpy</span>               <span class="k">as</span>  <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyLIQTR.clam.physical_data</span>  <span class="k">as</span>  <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>



<span class="c1">############################################################################</span>
<span class="c1">###</span>
<span class="c1">###   CLASS     Geometry                                           (none)</span>
<span class="c1">###</span>
<span class="c1">############################################################################</span>
<span class="c1">###</span>
<span class="c1">###   DESCRIPTION</span>
<span class="c1">###</span>
<span class="c1">###      Class for handling and manipulating atomic geometries.  Assumes</span>
<span class="c1">###      orthorhombic coordinate system.</span>
<span class="c1">###</span>
<span class="c1">###   CONSTRUCTOR ARGUMENTS</span>
<span class="c1">###</span>
<span class="c1">###      coords      -   Coordinates specified as an array of tuples</span>
<span class="c1">###      labels      -   Atom labels if coordinates are provided as unlableled</span>
<span class="c1">###                      xyz tuples</span>
<span class="c1">###      filename    -   Path to an xyz file containing the coordinates</span>
<span class="c1">###      units       -   Units for coordinates set (default: &#39;angstrom&#39;)</span>
<span class="c1">###      process     -   That to converts to atomic units (Bohr) and centers</span>
<span class="c1">###                      coordinates geometrically about the origin.</span>
<span class="c1">###</span>
<span class="c1">###   EXAMPLE</span>
<span class="c1">###</span>
<span class="c1">###         Generate a single site with a Pauli X operator = -1.0*X</span>
<span class="c1">###</span>
<span class="c1">###         s0  =  Site([0,0],[&#39;X&#39;],[-1.0])</span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###   RETURNS</span>
<span class="c1">###</span>
<span class="c1">###      Geometry    -    Instance of the Geometry class</span>
<span class="c1">###</span>
<span class="c1">###   REQUIRES</span>
<span class="c1">###</span>
<span class="c1">###      clam.physical_data  as  pd</span>
<span class="c1">###      numpy               as  np</span>
<span class="c1">###</span>
<span class="c1">###   PUBLIC MEMBERS </span>
<span class="c1">###</span>
<span class="c1">###      units      -    Current unit specification for the coordinates</span>
<span class="c1">###      dim        -    Dimension of basis (number of basis elements)</span>
<span class="c1">###      coords     -    List of 3-tuples specifying atomic coordinates</span>
<span class="c1">###      labels     -    List of labels for each of the coordinates </span>
<span class="c1">###                      from &lt;coords&gt;</span>
<span class="c1">###      center     -    Center of coordinate set</span>
<span class="c1">###      minmax     -    List containing arrays with minimal and maximal</span>
<span class="c1">###                      bounding coordinates for set:</span>
<span class="c1">###         </span>
<span class="c1">###                         [ [x_min,y_min,z_min], [x_max,y_max,z_max] ]  </span>
<span class="c1">###</span>
<span class="c1">###      lengths    -    Lengths of bounding cell in canonical orthorhombic</span>
<span class="c1">###                      frame</span>
<span class="c1">###</span>
<span class="c1">###   PUBLIC ROUTINES  </span>
<span class="c1">###</span>
<span class="c1">###      load_coordinates          -   Loads coordinate set into geometry</span>
<span class="c1">###      align_to_principal_axes   -   Aligns principal axes to those of </span>
<span class="c1">###                                    the orthorhombic frame (unimplemented)</span>
<span class="c1">###      get_minmax                -   Calculate minmax bounding values of</span>
<span class="c1">###                                    coordinates in orthorhombic frame</span>
<span class="c1">###      get_center                -   Calculate geometric center of coordinates</span>
<span class="c1">###      recenter                  -   Recenter coordinates at origin</span>
<span class="c1">###      set_units                 -   Set unit specifciation for coordinates</span>
<span class="c1">###                                    ( *** no conversion performed *** )</span>
<span class="c1">###      convert                   -   Convert coordinates to new units</span>
<span class="c1">###      pairs                     -   Return list of coordinates paired with </span>
<span class="c1">###                                    labels:</span>
<span class="c1">###</span>
<span class="c1">###                                        [&#39;He&#39;, 1.000, 1.500, 3.000]</span>
<span class="c1">###</span>
<span class="c1">###      print_xyz                 -   Print coordinates to file or &lt;stdout&gt; in</span>
<span class="c1">###                                    .xyz format.</span>
<span class="c1">###      write_xyz                 -   Shortcut for writting coordinates as .xyz</span>
<span class="c1">###                                    file.</span>
<span class="c1">###      process                   -   Convert coordinates to Bohr and recenter</span>
<span class="c1">###                                      </span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###   MAGIC ROUTINES  </span>
<span class="c1">###</span>
<span class="c1">###     __str__()</span>
<span class="c1">###</span>
<span class="c1">###           Pretty-printing of comprehensive cell attributes.</span>
<span class="c1">###</span>

<div class="viewcode-block" id="Geometry">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry">[docs]</a>
<span class="k">class</span> <span class="nc">Geometry</span><span class="p">():</span>

    <span class="c1">##  __init__()</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Constructor for geometry class.  (see above)</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;angstrom&#39;</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span>      <span class="o">=</span>  <span class="mi">3</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">units</span>    <span class="o">=</span>  <span class="s1">&#39;angstrom&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>   <span class="o">=</span>  <span class="n">coords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>   <span class="o">=</span>  <span class="n">labels</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">center</span>   <span class="o">=</span>  <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minmax</span>   <span class="o">=</span>  <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lengths</span>  <span class="o">=</span>  <span class="kc">None</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_coordinates</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># if (self.coords is None):</span>
        <span class="c1">#     raise Exception(&quot;Geometry: Coordinates or a coordinate file must be specified.&quot;)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_bounds</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">process</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_bounds</span><span class="p">()</span>

        <span class="k">return</span>


    <span class="c1">##  load_coordinates()</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Driver for loading coordinates into the Geometry class from </span>
    <span class="c1">##  a file.  The file &lt;filename&gt; is assumed to have format</span>
    <span class="c1">##  &lt;ctype&gt; with units &lt;units&gt;.</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.load_coordinates">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.load_coordinates">[docs]</a>
    <span class="k">def</span> <span class="nf">load_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">ctype</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;angstrom&#39;</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">ctype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>       
            <span class="n">ctype</span> <span class="o">=</span> <span class="n">suffix</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>    

        <span class="k">if</span> <span class="p">(</span><span class="n">ctype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;xyz&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__load_coordinates_xyz</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">ctype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span> <span class="s1">&#39;pdb&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__load_coordinates_pdb</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsupported coordinate format &quot;</span><span class="o">+</span><span class="n">ctype</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

        <span class="k">return</span></div>

    

    <span class="c1">##  __load_coordinates_xyz()</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Loads coordinates from .xyz format file.</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__load_coordinates_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">fp</span>    <span class="o">=</span>  <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span>  <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">]</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># could just skim over the rest of the line to get property fields,</span>
        <span class="c1"># but leaving this functionality undefined for now</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="n">ents</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ents</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ents</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">ents</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">ents</span><span class="p">[</span><span class="mi">3</span><span class="p">])]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">N</span>        <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_bounds</span><span class="p">()</span>

        <span class="k">return</span>
    


    <span class="c1">##  __load_coordinates_xyz()</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Loads coordinates from .pdb format file.</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__load_coordinates_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>



    <span class="c1">##  __load_coordinates_xyz()</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Loads coordinates from .xyz format file.</span>
    <span class="c1">##</span>


    <span class="c1">## Calculate principal axes and rotate coordinates to align these axes</span>
    <span class="c1">## with an orthorhombic coordinate system.</span>
    <span class="c1">##</span>
<div class="viewcode-block" id="Geometry.align_to_principal_axes">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.align_to_principal_axes">[docs]</a>
    <span class="k">def</span> <span class="nf">align_to_principal_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>




    <span class="c1">##  __calculate_principal_axes()            (not implemented)</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Calculates principal axes for the specificed geometry.</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__calculate_principal_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>



    <span class="c1">##  __calculate_principal_axes()            (not implemented)</span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Rotates principal axes of geometry to align with canonical</span>
    <span class="c1">##  orthorhombic frame.</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__rotate_to_principal_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>




    <span class="c1">##  get_minmax()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Get bounding minimum and maximum values of specified  </span>
    <span class="c1">##  coordinates.  If &lt;silent=True&gt; this function returns</span>
    <span class="c1">##  the minmax arrays and a vector containing lengths of the </span>
    <span class="c1">##  minimal cell that bounds the coordinates.</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.get_minmax">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.get_minmax">[docs]</a>
    <span class="k">def</span> <span class="nf">get_minmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">lims</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
            <span class="n">lims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

        <span class="n">lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">lengths</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">silent</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="n">lengths</span><span class="p">)</span></div>

    




    <span class="c1">##  __set_bounds()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Set bounding values and lengths in geometry class as </span>
    <span class="c1">##  obtained from get_minmax() </span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__set_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">lims</span><span class="p">,</span> <span class="n">lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minmax</span>   <span class="o">=</span> <span class="n">lims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lengths</span>  <span class="o">=</span> <span class="n">lengths</span>

        <span class="k">return</span>



    <span class="c1">##  get_center()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Driver for calculating center of specified geometry</span>
    <span class="c1">## </span>
    <span class="c1">##      type  =  &#39;minmax&#39;     :   Center of bounding cell </span>
    <span class="c1">##               &#39;geometric&#39;  :   Geometric center of coordinates</span>
    <span class="c1">##               &#39;barycenter&#39; :   Center of mass of coordinates</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.get_center">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.get_center">[docs]</a>
    <span class="k">def</span> <span class="nf">get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;minmax&#39;</span><span class="p">):</span>
        
        <span class="n">ttype</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span>   <span class="p">(</span><span class="n">ttype</span> <span class="o">==</span> <span class="s1">&#39;minmax&#39;</span><span class="p">):</span>
            <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_center_minmax</span><span class="p">()</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">ttype</span> <span class="o">==</span> <span class="s1">&#39;geometric&#39;</span><span class="p">):</span>
            <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_center_geometric</span><span class="p">()</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">ttype</span> <span class="o">==</span> <span class="s1">&#39;barycenter&#39;</span><span class="p">):</span>
            <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_center_barycenter</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Unknown centering: &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">return</span><span class="p">(</span><span class="n">center</span><span class="p">)</span></div>




    <span class="c1">##  __get_center_geometric()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Caculates geometric center of coordinates</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__get_center_geometric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">coord_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="n">coord_center</span> <span class="o">+=</span> <span class="n">coord</span>

        <span class="k">return</span><span class="p">(</span><span class="n">coord_center</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
    


    <span class="c1">##  __get_center_geometric()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Caculates minmax center of coordinates</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__get_center_minmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
            <span class="n">center</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minmax</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">minmax</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>

        <span class="k">return</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
    

    <span class="c1">##  __get_center_barycenter()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Caculates barycenter of coordinates</span>
    <span class="c1">##</span>

    <span class="k">def</span> <span class="nf">__get_center_barycenter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>







    <span class="c1">##  recenter()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Recenters coordinates at origin (or point &lt;point&gt;).  </span>
    <span class="c1">##  (*** point *** unimplemented)</span>


<div class="viewcode-block" id="Geometry.recenter">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.recenter">[docs]</a>
    <span class="k">def</span> <span class="nf">recenter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;symmetric&#39;</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">lims</span><span class="p">,</span> <span class="n">lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>

        <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">shift</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">lengths</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">lims</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<span class="c1">#           new_coord = np.array(coord[1]) + shift</span>
            <span class="n">new_coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="o">+</span> <span class="n">shift</span>
            <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_coord</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">new_coords</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__set_bounds</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_center</span><span class="p">()</span>
        <span class="k">return</span></div>




    <span class="c1">##  get_units()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Returns current unit specification</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.get_units">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.get_units">[docs]</a>
    <span class="k">def</span> <span class="nf">get_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span></div>




    <span class="c1">##  set_units()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Sets unit specification for coordinates without doing a </span>
    <span class="c1">##  conversion.</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.set_units">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.set_units">[docs]</a>
    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">units</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">=</span><span class="n">units</span>
        <span class="k">return</span></div>

    


    <span class="c1">##  convert()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Converts existing units to  &lt;new_units&gt; (&#39;angstrom&#39; or &#39;bohr&#39;)</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.convert">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.convert">[docs]</a>
    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_units</span><span class="p">):</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">new_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">new_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;bohr&#39;</span><span class="p">)):</span>
            <span class="n">cfactor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">angstrom_to_bohr</span>
        <span class="k">elif</span> <span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;bohr&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">new_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span> <span class="p">):</span>
            <span class="n">cfactor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">bohr_to_angstrom</span>

        <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="o">*</span><span class="n">cfactor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">units</span>   <span class="o">=</span>  <span class="n">new_units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>  <span class="o">=</span>  <span class="n">new_coords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_bounds</span><span class="p">()</span>

        <span class="k">return</span></div>

    


    <span class="c1">##  pairs()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Returns list of coordinates paired with their atom labels</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.pairs">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.pairs">[docs]</a>
    <span class="k">def</span> <span class="nf">pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">as_list</span><span class="p">):</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)):</span>
                <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pair</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coord_pairs</span> <span class="o">=</span> <span class="n">pairs</span>

        <span class="k">return</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span></div>

    


    <span class="c1">##  print_xyz()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Print coordinates to a file or &lt;stdout&gt; in .xyz format. </span>
    <span class="c1">##  Coordinates are numbered if &lt;print_number=True&gt;</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.print_xyz">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.print_xyz">[docs]</a>
    <span class="k">def</span> <span class="nf">print_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_number</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">(</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">n_pairs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_pairs</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n_pairs</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_pairs</span><span class="p">:</span>
                    <span class="n">xyz_string</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;   &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;   &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;   &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xyz_string</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">n_pairs</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">atidx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_pairs</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">print_number</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">atidx</span><span class="p">,</span><span class="s2">&quot;:   &quot;</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">atidx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span></div>




    <span class="c1">##  write_xyz()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Write coordinates to file path &lt;filename&gt; in .xyz format. </span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.write_xyz">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.write_xyz">[docs]</a>
    <span class="k">def</span> <span class="nf">write_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_xyz</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span></div>




    <span class="c1">##  process()            </span>
    <span class="c1">## -------------------------------------------------------------</span>
    <span class="c1">##</span>
    <span class="c1">##  Convert coodinates to atomic units (Bohr) and recenter. </span>
    <span class="c1">##</span>

<div class="viewcode-block" id="Geometry.process">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.Geometry.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;bohr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recenter</span><span class="p">()</span>
        <span class="k">return</span></div>



    <span class="c1">## modify xyz printing to return coordinates as numbered set</span>
    <span class="c1">## and return that here.</span>
    <span class="c1">##</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span></div>

        <span class="c1"># coord_text = print_xyz(print_file=True)</span>

        <span class="c1"># return(coord_text)</span>







<span class="c1">##  AtomicLattice(Lattice)</span>
<span class="c1">## -------------------------------------------------------------</span>
<span class="c1">##</span>
<span class="c1">##  Class for building periodic lattices from coordinate </span>
<span class="c1">##  specifications.  </span>
<span class="c1">##</span>


<span class="c1"># class AtomicLattice(Lattice):</span>

<span class="c1">#     def __init__( self, </span>
<span class="c1">#                   vectors,</span>
<span class="c1">#                   size=None,</span>
<span class="c1">#                   unit=None,</span>
<span class="c1">#                   periodic=None,</span>
<span class="c1">#                   do_wrap=None,</span>
<span class="c1">#                   cell_vectors=None,</span>
<span class="c1">#                   centered=True        ):</span>

<span class="c1">#         Lattice.__init__(self,vectors,size=size,unit=unit,periodic=(False,False,False))</span>

<span class="c1">#         self.build(size)</span>

<span class="c1">#         if (cell_vectors is None):</span>
<span class="c1">#             self.cell_vecs = []</span>
<span class="c1">#             for n in range(len(vectors)):</span>
<span class="c1">#                 self.cell_vecs.append(size[n]*vectors[n])</span>
<span class="c1">#         else:</span>
<span class="c1">#             self.cell_vecs = np.array(cell_vectors)</span>
    
<span class="c1">#         if (do_wrap is None):</span>
<span class="c1">#             self.do_wrap  = []</span>
<span class="c1">#             for n in range(self.dim):</span>
<span class="c1">#                 self.do_wrap.append(False)</span>
<span class="c1">#         else:</span>
<span class="c1">#             self.do_wrap = do_wrap</span>

<span class="c1"># #        Set labels to something generic like x if none are specified but unit is specified?</span>
<span class="c1"># #       or should this be done in geometry</span>
<span class="c1">#         # if (unit is None):</span>
<span class="c1">#         #     self.labels = </span>


<span class="c1">#         self.build_geometry(do_wrap)</span>
    
<span class="c1">#         return</span>
    

<span class="c1">#     def wrap(self,coords):</span>

<span class="c1">#         new_coords = []</span>

<span class="c1">#         for x in coords:</span>
<span class="c1">#             for n in range(len(x[0])): </span>
<span class="c1">#                 if ( self.do_wrap[n] == True):</span>
<span class="c1">#                     if (x[0][n] &gt;= self.cell_vecs[n][n]):</span>
<span class="c1">#                         x[0][n] -= self.cell_vecs[n][n]</span>

<span class="c1">#                     if (x[0][n] &lt; 0.0):</span>
<span class="c1">#                         x[0][n] += self.cell_vecs[n][n]</span>

<span class="c1">#             new_coords.append(x[0])</span>

<span class="c1">#         return(new_coords)</span>


<span class="c1">#     def build_geometry(self,do_wrap=None):</span>

<span class="c1">#         labels = self.labels[0]</span>

<span class="c1">#         coords = []</span>
<span class="c1">#         for coord in self.skeletons[0]:</span>
<span class="c1">#             coords.append(coord)</span>

<span class="c1">#         new_coords = self.wrap(coords)</span>

<span class="c1">#         self.geometry = Geometry(coords=new_coords,labels=labels)</span>

<span class="c1">#         return</span>







<span class="c1">##  geometry_angstrom_to_bohr()            </span>
<span class="c1">## -------------------------------------------------------------</span>
<span class="c1">##</span>
<span class="c1">##  Convert coodinates &lt;geom&gt; in angstrom to bohr (or bohr to </span>
<span class="c1">##  angstrom via &lt;invert=True&gt;.</span>
<span class="c1">##</span>

<div class="viewcode-block" id="geometry_angstrom_to_bohr">
<a class="viewcode-back" href="../../../../docs/_modules/src.pyLIQTR.clam.html#src.pyLIQTR.clam.geometry.geometry_angstrom_to_bohr">[docs]</a>
<span class="k">def</span> <span class="nf">geometry_angstrom_to_bohr</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">new_geom</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">invert</span><span class="p">):</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">angstrom_to_bohr</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">bohr_to_angstrom</span>

    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">geom</span><span class="p">:</span>
        <span class="n">new_geom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">sf</span><span class="p">)])</span>

    <span class="k">return</span><span class="p">(</span><span class="n">new_geom</span><span class="p">)</span></div>










</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, MIT Lincoln Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>